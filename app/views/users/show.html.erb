<% provide(:title, "My Page") %>
<!-- ログインユーザーの情報 -->
<section class="hero is-dark is-halfheight">
  <div class="hero-body">
    <div class="container">
      <div class="columns is-centered">
        <div class="column is-12-mobile is-10-tablet is-11-desktop is-10-widescreen is-10-fullhd">
          <div class="box">
            <div class="field has-text-centered">
              <strong>アカウント情報</strong>
            </div>
            <div class="box">
              <div class="field">
                <div class="user-icon-field">
                  <% if current_user.image? %>
                    <%= image_tag current_user.image.url, class: "user-image", alt: "ユーザーアイコン" %>
                  <% else %>
                    <%= image_tag avatar_url(current_user), class: "user-image", alt: "ユーザーアイコン" %>
                  <% end %>
                </div>
                <%= form_with scope: :user, url: users_show_url(current_user), action: :update, method: :post do |f| %>
                  <div class="file">
                    <label class="button is-primary is-outlined is-fullwidth">
                      <%= f.file_field :avatar, accept: 'image/jpeg,image/gif,image/png', class: "file-input", onchange: "this.form.submit();" %>
                      <i class="fas fa-upload"></i>&nbsp;&nbsp;アイコン画像の変更
                    </label>
                  </div>
                <% end %>
              </div>
              <div class="field">
                <span class="user-element">アカウント名: <%= current_user.name %></span>
              </div>
              <div class="field">
                <span class="user-element">調理ジャンル: <%= current_user.introduction %></span>
              </div>
              <div class="field">
                <span class="user-element appear-user-data">アクティビティの確認</span>
                <div class="user-data">
                  <span class="user-element">投稿件数: <%= @posts.count %>件</span>
                  <span class="user-element">コメントした回数: <%= current_user.comments.count %>回</span>
                  <span class="user-element"><i class="fa fa-star" style="color: #209cee;"></i>を押した投稿件数: <%= current_user.liked_posts.count %>件</span>
                  <span class="user-element"><i class="fa fa-book" style="color: green;"></i>を押した投稿件数: <%= current_user.checked_remember_posts.count %>件</span>
                  <span class="user-element"><i class="fa fa-star" style="color: #209cee;"></i>をもらった回数: <%= @received_like %>回</span>
                  <span class="user-element"><i class="fa fa-book" style="color: green;"></i>をもらった回数: <%= @received_remember %>回</span>
                </div>
              </div>
              <% if current_user.email != "guest@sample.com" %>
                <div class="field">
                  <%= link_to edit_user_registration_path do %>
                    <i class="far fa-sun"></i>
                    <span class="link-btn">setting</span>
                  <% end %>
                </div>
              <% end %>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- 表示するセクション選択 -->
<section class="appear-section-links">
  <span class="appear-posted-section appear-link">投稿一覧</span>
  <span class="appear-remember-section appear-link"><i class="fa fa-book" style="color: green;"></i></span>
</section>
<!-- ログインユーザーの投稿一覧 -->
<section class="user-posted-section">
  <div class="posts-container">
    <div class="posts-contents">
      <% if @posts.count.zero? %>
        <div class="zero-info posts-zero">まだあなたの投稿はありません</div>
      <% else %>
        <% @posts.each do |post| %>
          <div class="post-area">
            <%= link_to post_path(post.id) do %>
              <figure>
                <%= image_tag(avatar_url(post.user), class: "posted-user-icon", alt: "ユーザーアイコン") %>
              </figure>
              <div class="post-area-text">
                <div class="posted-user-name"><%= post.user.name %>(<%= post.user.introduction %>)</div>
                <div class="posted-date"><%= post_time(post.created_at) %></div>
                <div class="post-text">
                  <span class="post-title"><%= post.title %></span>
                  <span class="post-content"><%= simple_format(post.post_content) %></span>
                  <% unless post.avatar.blank? %>
                    <div class="post-pict">
                      <%= image_tag(post_image_url(post), class: "post-image", alt: "投稿画像") %>
                    </div>
                  <% end %>
                  <div id="like-buttons-<%= post.id %>">
                    <% if current_user.already_liked?(post) %>
                      <%= link_to post_likes_path(post.id), method: :delete, remote: true do %>
                        <span class="like-count" style="color: #209cee;"><i class="fa fa-star"></i></i>&nbsp;<%= post.likes.count %></span>
                      <% end %>
                    <% else %>
                      <%= link_to post_likes_path(post.id), method: :post, remote: true do %>
                        <span class="like-count" style="color: silver;"><i class="fa fa-star"></i>&nbsp;<%= post.likes.count %></span>
                      <% end %>
                    <% end %>
                  </div>
                  <div id="remember-buttons-<%= post.id %>">
                    <% if current_user.checked_remember?(post) %>
                      <%= link_to post_remembers_path(post.id), method: :delete, remote: true do %>
                        <span class="remember-count" style="color: green;"><i class="fa fa-book"></i></i>&nbsp;<%= post.remembers.count %></span>
                      <% end %>
                    <% else %>
                      <%= link_to post_remembers_path(post.id), method: :post, remote: true do %>
                        <span class="remember-count" style="color: silver;"><i class="fa fa-book"></i></i>&nbsp;<%= post.remembers.count %></span>
                      <% end %>
                    <% end %>
                  </div>
                  <% if current_user.already_commented?(post) %>
                    <span class="comment-count" style="color: coral;"><i class="fa fa-comments"></i>&nbsp;<%= post.comments.count %></span>
                  <% else %>
                    <span class="comment-count" style="color: silver;"><i class="fa fa-comments"></i>&nbsp;<%= post.comments.count %></span>
                  <% end %>
                </div>
              </div>
            <% end %>
          </div>
        <% end %>
      <% end %>
    </div>
  </div>
</section>
<!-- rememberした投稿一覧 -->
<section class="remember-posts-section">
  <div class="posts-container">
    <div class="posts-contents">
      <% if @remember_posts.count.zero? %>
        <div class="zero-info posts-zero">まだ <i class="fa fa-book" style="color: green; font-size: 15px;"></i> を押した投稿はありません</div>
      <% else %>
        <% @remember_posts.each do |post| %>
          <div class="post-area">
            <%= link_to post_path(post.id) do %>
              <figure>
                <%= image_tag(avatar_url(post.user), class: "posted-user-icon", alt: "ユーザーアイコン") %>
              </figure>
              <div class="post-area-text">
                <div class="posted-user-name"><%= post.user.name %>(<%= post.user.introduction %>)</div>
                <div class="posted-date"><%= post_time(post.created_at) %></div>
                <div class="post-text">
                  <span class="post-title"><%= post.title %></span>
                  <span class="post-content"><%= simple_format(post.post_content) %></span>
                  <% unless post.avatar.blank? %>
                    <div class="post-pict">
                      <%= image_tag(post_image_url(post), class: "post-image", alt: "投稿画像") %>
                    </div>
                  <% end %>
                  <% if current_user.already_commented?(post) %>
                    <span class="comment-count" style="color: coral;"><i class="fa fa-comments"></i>&nbsp;<%= post.comments.count %></span>
                  <% else %>
                    <span class="comment-count" style="color: silver;"><i class="fa fa-comments"></i>&nbsp;<%= post.comments.count %></span>
                  <% end %>
                  <% if current_user.already_liked?(post) %>
                    <span class="like-count" style="color: #209cee;"><i class="fa fa-star"></i></i>&nbsp;<%= post.likes.count %></span>
                  <% else %>
                    <span class="like-count" style="color: silver;"><i class="fa fa-star"></i></i>&nbsp;<%= post.likes.count %></span>
                  <% end %>
                  <% if current_user.checked_remember?(post) %>
                    <span class="remember-count" style="color: green;"><i class="fa fa-book"></i></i>&nbsp;<%= post.remembers.count %></span>
                  <% else %>
                    <span class="remember-count" style="color: silver;"><i class="fa fa-book"></i></i>&nbsp;<%= post.remembers.count %></span>
                  <% end %>
                </div>
              </div>
            <% end %>
          </div>
        <% end %>
      <% end %>
    </div>
  </div>
</section>
<%= javascript_pack_tag 'user/show' %>
